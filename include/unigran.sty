%% 
%% NÃO REMOVA ESSE ARQUIVO!
%% Customizações do abnTeX2 (http://abnTeX2.googlecode.com) para a UNIGRAN
%%
%% This work may be distributed and/or modified under the
%% conditions of the LaTeX Project Public License, either version 1.3
%% of this license or (at your option) any later version.
%% The latest version of this license is in
%%   http://www.latex-project.org/lppl.txt
%% and version 1.3 or later is part of all distributions of LaTeX
%% version 2005/12/01 or later.
%%
%% This work has the LPPL maintenance status `maintained'.
%%
%%
%% Further information about abnTeX2 are available on https://github.com/abntex/abntex2
%% Baseado no template UECETeX e ABNTeX2
%%

% ---
% INICIO DAS CUSTOMIZACOES PARA A UNIGRAN
% ---

\ProvidesPackage{unigran}[2018/09/14 Criacao desta customizacao do abnTeX2]

\RequirePackage[table,xcdraw,rgb]{xcolor}
\RequirePackage[utf8]{inputenc}		% Codificação do documento (conversão automática dos acentos)
\RequirePackage{setspace}
%times new roman - pslatex
\RequirePackage{pslatex} 
\RequirePackage{listings}
\usepackage[portuguese,ruled,lined]{algorithm2e}    % Escrever algoritmos
\usepackage{algorithmic}                            % Criar Algoritmos  

%\usepackage{abnt}



%cores oficiais da UNIGRAN
\definecolor{yellow}{RGB}{255,204,0}
\definecolor{blue}{RGB}{0,0,128}

% alterando a capa
\renewcommand{\imprimircapa}{%
  \begin{capa}%
    \center
    \vspace{0.6cm}
   
    {{\textbf{Instituto Nacional de Metrologia, Qualidade e Tecnologia – INMETRO}}}
    
    \vfill

    {\bfseries\large\imprimirautor}

    \vfill
    
    \begin{center}
    \bfseries\Large\MakeTextUppercase{\imprimirtitulo}
    \end{center}
    
    \vfill
	
	\vfill
	
    \bfseries\large{\imprimirlocal}\par
    \bfseries{\imprimirdata}
  \end{capa}
}


% folha de rosto 
\makeatletter

\renewcommand{\folhaderostocontent}{
\begin{center}
    \vspace{0.6cm}
    {\large\imprimirautor}
    
    \vspace*{\fill}\vspace*{\fill}
    
    \begin{center}
    {\bfseries\MakeTextUppercase{\imprimirtitulo}}
    \end{center}
    
    \vspace*{\fill}
    
    {\hbadness=100000
    \abntex@ifnotempty{\imprimirpreambulo}{%
      \hspace{.45\textwidth}
      \begin{minipage}{.5\textwidth}
      \SingleSpacing
      \imprimirpreambulo\\%
      \par%espaco entre o preambulo-outros
      
      \end{minipage}%
      
      \vspace*{\fill}
    }%
    {\large ~\imprimirorientador\par}
    Orientador\\
    \abntex@ifnotempty{\imprimircoorientador}{%
    {\large ~\imprimircoorientador\par}%
    Coorientador
    }%
    
    }
    \vspace*{\fill}
    
    {\imprimirlocal}
    
    \par
    \vspace{-0.3cm}
    
    {\imprimirdata}
    \end{center}
    \newpage
    \begin{center}
    \vspace{0.6cm}
    {\large\imprimirautor}
    
    \vspace*{\fill}\vspace*{\fill}
    
    \begin{center}
    {\bfseries\MakeTextUppercase{Título da tese ou dissertação em inglês}}
    \end{center}
    
    \vspace*{\fill}
    
    {\hbadness=100000
    \abntex@ifnotempty{[Master thesis] [Doctoral dissertation] [Monograph for qualifying to the Doctoral study] submitted as partial fulfilment of the requirements for the Degree of [Master] [Doctor] of Science in the Postgraduate Program in [Biotechnology] [Metrology] Metrology and Quality] of the National Institute of Metrology, Quality, and Technology.}{%
      \hspace{.45\textwidth}
      \begin{minipage}{.5\textwidth}
      \SingleSpacing
      [Master thesis] [Doctoral dissertation] [Monograph for qualifying to the Doctoral study] submitted as partial fulfilment of the requirements for the Degree of [Master] [Doctor] of Science in the Postgraduate Program in [Biotechnology] [Metrology] Metrology and Quality] of the National Institute of Metrology, Quality, and Technology.\\%
      \par%espaco entre o preambulo-outros
      
      \end{minipage}%
      
      \vspace*{\fill}
    }%
    {\large ~\imprimirorientador\par}
    Advisor\\
    \abntex@ifnotempty{\imprimircoorientador}{%
    {\large ~\imprimircoorientador\par}%
    Coadvisor
    }%
    
    }
    \vspace*{\fill}
    
    {\imprimirlocal}
    
    \par
    \vspace{-0.3cm}
    
    {\imprimirdata}
    \end{center}
}

\makeatother



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%       Metadados do Documento       %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\AtBeginDocument{ %
	% Adiciona os metadados do documento gerado
	\hypersetup{ %
		pdftitle={\imprimirtitulo},%
		pdfauthor={\imprimirautor}, %
		pdfsubject={\imprimirpreambulo}, %
		pdfcreator={LaTeX com abnTeX2, modelo UNIGRAN} %
		colorlinks=true,       		% false: boxed links; true: colored links
    	linkcolor=black,        %linkcolor=blue,       	% color of internal links
    	citecolor=black,        %citecolor=blue,    		% color of links to bibliography
    	filecolor=magenta,                          		% color of file links
		urlcolor=black,           %urlcolor=blue,
		bookmarksdepth=4
	}%
	% Define a altura das equacoes matematicas
%	\abovedisplayskip=-1pt plus 3pt minus 9pt
%	\abovedisplayshortskip=0pt plus 3pt
%	\belowdisplayskip=18pt plus 3pt minus 9pt
	\addtolength\belowdisplayshortskip{\onelineskip}
}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%       Formatação das Páginas        %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Define o espaço entre linhas para 1.5 cm
%\OnehalfSpacing	Bug no ABNTEX2?
\renewcommand{\baselinestretch}{1.5}

%\OnehalfSpacing

% Define as margens do documento
\setlrmarginsandblock{3cm}{2cm}{*} % externa / interna
\setulmarginsandblock{3cm}{2cm}{*} % superior / inferior
\checkandfixthelayout

% Espacamentos nos titulos:
% chapter
\setlength{\beforechapskip}{-\onelineskip} %com 0 nao funcionou
\setlength{\afterchapskip}{\onelineskip} % antes do titulo de capitulo
%\setlength\beforechapskip{-18pt}
%\setlength{\afterchapskip}{2cm}

% section
%\setbeforesecskip{\onelineskip}
\setbeforesecskip{18pt}
\setaftersecskip{\onelineskip}

% subsection
\setbeforesubsecskip{\onelineskip}
\setaftersubsecskip{\onelineskip}

% subsubsection
\setbeforesubsubsecskip{\onelineskip}
\setaftersubsubsecskip{\onelineskip}

% subsubsubsection
\setbeforeparaskip{\onelineskip}
\setafterparaskip{\onelineskip}

% Define a distância da margem esquerda do parágrafo
\setlength{\parindent}{1.25cm}

% Estilo do chapter 1
\renewcommand{\ABNTEXchapterfont}{\bfseries}
\renewcommand{\ABNTEXchapterfontsize}{\normalsize}

% Estilo da section 1.1
\renewcommand{\ABNTEXsectionfont}{\bfseries}
\renewcommand{\ABNTEXsectionfontsize}{\normalsize}

% Estilo da subsection 1.1.1
\renewcommand{\ABNTEXsubsectionfont}{\bfseries}
\renewcommand{\ABNTEXsubsectionfontsize}{\normalsize}

% Estilo da subsection 1.1.1.1
\renewcommand{\ABNTEXsubsubsectionfont}{\bfseries}
\renewcommand{\ABNTEXsubsubsectionfontsize}{\normalsize}

% Estilo da subsection 1.1.1.1
\renewcommand{\ABNTEXsubsubsubsectionfont}{\normalfont\itshape}
\renewcommand{\ABNTEXsubsubsubsectionfontsize}{\normalsize}



% Espaçamento entre o texto e a legenda
%\setlength{\belowcaptionskip}{\onelineskip}

% Retira espaço extra obsoleto entre as frases.
%\frenchspacing

\addto\captionsbrazil{
	\renewcommand{\bibname}{REFER\^ENCIAS}
	\renewcommand{\indexname}{\'INDICE}
	%problema aqui, se mandar imprimir no bookmark, dá problema
	\renewcommand{\contentsname}{Sum\'ario \vspace{5pt}}
	\renewcommand{\listadesimbolosname}{Lista de Símbolos}
}

%correcao do problema anterior
\newcommand{\contentsnamebookmark}{Sum\'ario}


% Por algum motivo, o algorithm2e estava pegando algumas palavras do espanhol.
% Acredito que seja porque os comandos \para seja idêntico nos dois idiomas.
% Esses comando resolvem o problema
\SetKwFor{Para}{para}{fa\c{c}a}{fim para}
\SetKwBlock{Inicio}{inicio}{fim}

% Na versao mais nova do algorithm2e (versao 5.1) aparentemente foram adicionados
% algumas palavras com acentuacao e por isso estava causando erro no template. 
% Os comandos a seguir foram copiados da versao mais nova para tentar resolver o problema.
\SetKwInput{Entrada}{Entrada}%
\SetKwInput{Saida}{Sa\'{i}da}%
\SetKwInput{Dados}{Dados}%
\SetKwInput{Resultado}{Resultado}%
\SetKw{Ate}{at\'{e}}
\SetKw{KwRetorna}{retorna}%
\SetKw{Retorna}{retorna}%
\SetKwBlock{Inicio}{in\'{i}cio}{fim}%
\SetKwRepeat{Repita}{repita}{at\'{e}}%
%
\SetKwIF{Se}{SenaoSe}{Senao}{se}{ent\~{a}o}{sen\~{a}o se}{sen\~{a}o}{fim se}%
\SetKwSwitch{Selec}{Caso}{Outro}{selecione}{fa\c{c}a}{caso}{sen\~{a}o}{fim caso}{fim selec}%
\SetKwFor{Para}{para}{fa\c{c}a}{fim para}%
\SetKwFor{ParaPar}{para}{fa\c{c}a em paralelo}{fim para}
\SetKwFor{ParaCada}{para cada}{fa\c{c}a}{fim para cada}%
\SetKwFor{ParaTodo}{para todo}{fa\c{c}a}{fim para todo}%
\SetKwFor{Enqto}{enquanto}{fa\c{c}a}{fim enqto}%

% Espaco entre as linhas do algoritmo
\newcommand{\SetSpacedAlgorithm}{
	\linespread{1.35}\selectfont
}

% Altera o titulo para esse
\renewcommand{\listalgorithmcfname}{Lista de Algoritmos}%

% Espaco entre o caption e o algoritmo
%\SetAlCapSkip{\onelineskip}

% Distance between floats on the top or the bottom and the text;
\setlength{\textfloatsep}{18pt plus 2pt minus 2pt}

% Distance between floats inserted inside the page text (using h) and the text proper.
\setlength{\intextsep}{18pt plus 2pt minus 2pt}

\newcommand{\Caption}[1]{ %
	\begin{Spacing}{1.5} %
       	\caption{#1} %
   	\end{Spacing} %
}

\newcommand{\Fonte}[2][\fontename]{ %
%	\vspace{-3pt}
	\vspace{8pt}
 		\fonte[#1]{#2}
 	\vspace{-5pt}
}

% Cria o comando para fazer notas e anotacoes na figura e na tabela
\newcommand{\Nota}[2][\notaname]{\Fonte[#1]{#2}} 





% Numeracao da tabela comeca em 1
\setcounter{table}{0}

% Comandos para inserir figuras, tabelas e quadros
\newcommand{\UECEfig}[3]{\IBGEtab{#1}{#2}{#3}}
\newcommand{\UECEtab}[3]{\IBGEtab{#1}{#2}{#3}}
\newcommand{\UECEqua}[3]{\IBGEtab{#1}{#2}{#3}}

% Ambiente para alineas e e subalineas (incisos) com ponto
\newlist{alineascomponto}{itemize}{2}
\setlist[alineascomponto,1]{label={$\bullet$},topsep=0pt,itemsep=0pt,leftmargin=\parindent+\labelwidth-\labelsep}%
\setlist[alineascomponto,2]{label={--},topsep=0pt,itemsep=0pt,leftmargin=*}
\newlist{subalineascomponto}{enumerate}{1}
\setlist[subalineascomponto,1]{label={$\circ$},topsep=0pt,itemsep=0pt,leftmargin=*}%
% ---

% Ambiente para alineas e e subalineas (incisos) com numeros
\newlist{alineascomnumero}{enumerate}{2}
\setlist[alineascomnumero,1]{label={$\arabic*$.},topsep=0pt,itemsep=0pt,leftmargin=\parindent+\labelwidth-\labelsep}%
\setlist[alineascomnumero,2]{label={--},topsep=0pt,itemsep=0pt,leftmargin=*}
\newlist{subalineascomnumero}{enumerate}{1}
\setlist[subalineascomnumero,1]{label={$\arabic*$.},topsep=0pt,itemsep=0pt,leftmargin=*}%
% ---




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%             Dedicatoria             %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\imprimirdedicatoria}[1]{
	\ifthenelse{\boolean{uecetex2@ehqualificacao}}{}{
		\vspace*{20cm}
		\vfill
		%Retira o espaço do parágrafo
		\hspace*{-2cm}
		%Adiciona o espaço da margem
		\hspace*{8cm}	
		\begin{minipage}{8cm}
			\input{#1}
		\end{minipage}
		\pagebreak
	}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                Errata               %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\imprimirerrata}[1]{%
	\ifthenelse{\boolean{uecetex2@ehqualificacao}}{}{%
		\begin{errata} %
		\input{#1}%
		\end{errata}%
	}%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%            Agradecimentos           %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\imprimiragradecimentos}[1]{ 
	\ifthenelse{\boolean{uecetex2@ehqualificacao}}{}{
		\begin{agradecimentos}
			\begin{paracol}{1}
				\setlength{\parindent}{0pt}%
				\input{#1}
			\end{paracol}		
		\end{agradecimentos}
	}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%               Epígrafe              %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\imprimirepigrafe}[1]{
	\ifthenelse{\boolean{uecetex2@ehqualificacao}}{}{
		\vspace*{\fill}
		\vfill
		%Retira o espaço do parágrafo
		\hspace*{-2cm}
		%Adiciona o espaço da margem
		\hspace*{8cm}	
		\begin{minipage}{8cm}
			\input{#1}
			\raggedleft{(\imprimirautordaepigrafe) \par}
		\end{minipage}		
		\pagebreak
	}
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%          Ficha Catalografica        %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\imprimirfichacatalografica}[1]{%
	\ifthenelse{\boolean{uecetex2@ehqualificacao}}{}{%
		\includepdf[pages=1]{#1} %
	}%
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%               Resumo                %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\palavraschave}[1]{ %
	\vspace{\onelineskip} 
	\noindent \textbf{Palavras-chave:} #1%
	\hypersetup{%
		pdfborder = {0 0 0}
	}
}

\newcommand{\keywords}[1]{ %
	\vspace{\onelineskip} 
	\noindent \textbf{Keywords:} #1%
}

\newcommand{\imprimirresumo}[1]{ %
	\begin{resumo} %
		\input{#1} %
	\end{resumo} %
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%               Abstract              %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\imprimirabstract}[1]{ %
	\begin{resumo}[Abstract] %
		\input{#1} %
	\end{resumo} %
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%         Lista de Quadro             %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Novo list of (listings) para QUADROS

\newcommand{\quadroname}{Quadro}
\newcommand{\listofquadrosname}{Lista de Quadros}

\newfloat[chapter]{quadro}{loq}{\quadroname}
\newlistof{listofquadros}{loq}{\listofquadrosname}
\newlistentry{quadro}{loq}{0}

% configurações para atender às regras da ABNT
\counterwithout{quadro}{chapter}
\renewcommand{\cftquadroname}{\quadroname\space} 
\renewcommand*{\cftquadroaftersnum}{\hfill--\hfill}


\newcommand{\imprimirlistadequadros}{ %
	%\pdfbookmark[0]{\listofquadrosname}{loq} %
	\listofquadros* %
	\pagebreak %
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%         Lista de Códigos-fonte      %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Comandos para formatar a exibicao de codigos-fonte

\renewcommand{\lstlistingname}{Código-fonte}% Listing -> Algorithm
\renewcommand{\lstlistlistingname}{Lista de Códigos-Fonte}%

%\AtBeginDocument{ %
%	\counterwithout{lstlisting}{chapter}
%}

\lstset{
	commentstyle=\color{green}\ttfamily,
	basicstyle=\ttfamily,
	xleftmargin=15pt,
	stepnumber=1, 
	numbers=left,
	keywordstyle=\color{blue},
	tabsize=2,	
	rulecolor=\color{black},
	upquote=true,
	numberstyle=\tiny\color{gray},
	stepnumber=1,
	numbersep=8pt,
	showstringspaces=false,
	breaklines=true,
	frame=single,
	belowskip=\onelineskip,
	belowcaptionskip=\onelineskip
}

%\newfloat[chapter]{codigofonte}{locf}{\lstlistingname}
%\newlistof{listofcodigosfonte}{locf}{\lstlistlistingname}
%\newlistentry{codigofonte}{locf}{0}
%
%% configurações para atender às regras da ABNT
%\counterwithout{codigofonte}{chapter}
%\renewcommand{\cftcodigofontename}{\lstlistingname\space} 
%\renewcommand*{\cftcodigofonteaftersnum}{\hfill--\hfill}

\AtBeginDocument{ %
	\counterwithout{lstlisting}{chapter}
}

\newlength\mylen

\begingroup
\makeatletter
\let\newcounter\@gobble\let\setcounter\@gobbletwo
\globaldefs\@ne \let\c@loldepth\@ne
\newlistof{listings}{lol}{\lstlistlistingname}
\newlistentry{lstlisting}{lol}{0}
\makeatother
\endgroup

\renewcommand\cftlstlistingpresnum{\lstlistingname~}
\settowidth\mylen{\cftlstlistingpresnum\cftlstlistingaftersnum}
\addtolength\cftlstlistingnumwidth{\mylen} %
\renewcommand\cftlstlistingaftersnum{\hfill\textendash\hfill}


\newcommand{\imprimirlistadecodigosfonte}{ %
	%\pdfbookmark[0]{\listofquadrosname}{loq} %
	\begin{KeepFromToc} %
		\lstlistoflistings %
	\end{KeepFromToc} %
	\pagebreak %
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%         Lista de Ilustrações        %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% A lista de Ilustrações não deve aparecer no sumário

\newcommand{\imprimirlistadeilustracoes}{
	\begin{KeepFromToc} %
		\listoffigures\pagebreak %
	\end{KeepFromToc} %
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%         Lista de Algoritmos         %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newlength\myAlgoLen

\begingroup
\makeatletter
\let\newcounter\@gobble\let\setcounter\@gobbletwo
\globaldefs\@ne \let\c@loadepth\@ne
\newlistof{algorithms}{loa}{\listalgorithmname}
\newlistentry{algocf}{loa}{0}
\makeatother
\endgroup

\renewcommand\cftalgocfpresnum{\algorithmcfname~}
\settowidth\myAlgoLen{\cftalgocfpresnum\cftalgocfaftersnum}
\addtolength\cftalgocfnumwidth{\myAlgoLen} %
\renewcommand\cftalgocfaftersnum{\hfill\textendash\hfill}


% A lista de Algoritmos não deve aparecer no sumário

\newcommand{\imprimirlistadealgoritmos}{
	\listofalgorithms
	\pagebreak %
}

% agora a lista de quadro eh negrito
\renewcommand{\cftalgocffont}{\bfseries}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%            Lista de Tabelas         %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% A lista de tabela não deve aparecer no sumário
\newcommand{\imprimirlistadetabelas}{ %
	\begin{KeepFromToc} %
		\listoftables \pagebreak%
	\end{KeepFromToc} %
}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%         Lista de Simbolos           %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\imprimirlistadesimbolos}[1]{
	\input{#1}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%               Apendices             %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Define o titulo no sumario do Apendice para nao negrito
\newcommand{\apendice}[1]{\chapter{\normalfont{#1}}}

% O nome APÊNDICES deve vir em página distinta, redigido em letras maiúsculas, centralizado, negritado, tamanho da fonte 12.
\newcommand{\imprimirpaginaapendices}{ %
	\newpage %
	\thispagestyle{empty}
	%\addcontentsline{toc}{chapter}{AP\^ENDICES} %
	\begin{vplace}[0.7] %
		\centering\textbf{AP\^ENDICES} %
	\end{vplace} %
	\clearpage
}

% Altera a fonte da letra titulo do apendice para nao negrito
\renewcommand{\chaptitlefont}{ %
	\ifthenelse{\boolean{abntex@apendiceousecao}}{ %
		\normalfont\normalsize %
	}{%
		\ABNTEXchapterfont\ABNTEXchapterfontsize %
	}%
}

% Retira o negrito do apêndice e o coloca alinhado a esquerda
\renewcommand{\printchaptertitle}[1]{%
	\chaptitlefont%
	\ifthenelse{\boolean{abntex@innonumchapter}}{\centering\ABNTEXchapterupperifneeded{#1}}{%
		\ifthenelse{\boolean{abntex@apendiceousecao}}{%
			\normalfont
			\settowidth{\chapternamenumlength}{\printchaptername\printchapternum\afterchapternum}%
			\hspace{-0.3cm} %
			#1 %	\ABNTEXchapterupperifneeded{#1}%
		}{%
			\settowidth{\chapternamenumlength}{\printchaptername\printchapternum\afterchapternum}%
			\parbox[t]{\columnwidth-\chapternamenumlength}{\ABNTEXchapterupperifneeded{#1}}
		}%
	}    
}

\newcommand{\imprimirapendices}{ %
	\imprimirpaginaapendices
	\apendices %
	% Retira o negrito da palavra "Apendice"
	\PRIVATEapendiceconfig{\normalfont\apendicename}{\normalfont\apendicesname} %
	
}

% Correcao do problema de espacamento entre as palavras
\renewcommand{\printchapternum}{%
	\tocprintchapter
	\setboolean{abntex@innonumchapter}{false}
	\chapnumfont%
	\ifthenelse{\boolean{abntex@apendiceousecao}}{%
		\hspace{-0.3cm} %
	}{}%
	\space\thechapter\space%
	\ifthenelse{\boolean{abntex@apendiceousecao}}{%
		\tocinnonumchapter
		~\textendash~%
	}{} % else
}

% Remove uppercase do apendice e anexos
\makeatletter
\ifthenelse{\boolean{ABNTEXsumario-abnt-6027-2012}}{
	\settocpreprocessor{chapter}{%
		\ifthenelse{\boolean{abntex@apendiceousecao}}{%
			\let\tempf@rtoc\f@rtoc%
			\def\f@rtoc{%
				\texorpdfstring{\tempf@rtoc}{\tempf@rtoc}}%
		}{
		\let\tempf@rtoc\f@rtoc%
		\def\f@rtoc{%
			\texorpdfstring{\MakeTextUppercase{\tempf@rtoc}}{\tempf@rtoc}}%
	}
}
\settocpreprocessor{part}{%
	\let\tempf@rtoc\f@rtoc%
	\def\f@rtoc{%
		\texorpdfstring{\MakeTextUppercase{\tempf@rtoc}}{\tempf@rtoc}}%
}
}{}
\makeatother
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%           Número das Páginas        %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\makepagestyle{abntheadings}
\makeevenhead{abntheadings}{\ABNTEXfontereduzida\thepage}{}{\ABNTEXfontereduzida\textit}
\makeoddhead{abntheadings}{}{}{\ABNTEXfontereduzida\thepage}
%\makeheadrule{abntheadings}{}{}

% Cabecalho do inicio do capitulo
\makepagestyle{abntchapfirst}
\makeoddhead{abntchapfirst}{}{}{\ABNTEXfontereduzida\thepage}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                Anexos               %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


% Define o titulo no sumario do Anexo para nao negrito
\newcommand{\anexo}[1]{\chapter{\normalfont{#1}}}

% O nome ANEXOS deve vir em página distinta, redigido em letras maiúsculas, centralizado, negritado, tamanho da fonte 12.
\newcommand{\imprimirpaginaanexo}{ %
	\newpage %
	\thispagestyle{empty}
	%\addcontentsline{toc}{chapter}{ANEXOS} %
	\begin{vplace}[0.7] %
		\centering\textbf{ANEXOS} %
	\end{vplace} %
	\clearpage
}

\newcommand{\imprimiranexos}{ %
	\imprimirpaginaanexo
	\anexos %
	% Retira o negrito da palavra "Apendice"
	\PRIVATEapendiceconfig{\normalfont\anexoname}{\normalfont\anexosname} %
	
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                Indice               %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\imprimirindice}{ %
	\printindex
}

\newcommand{\citeautoronline}[1]{ %
	\unskip\citeauthoronline{#1} (\citeyear{#1})\xspace %
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%        Configuração do Sumário      %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\renewcommand{\contentsname}{}

\newcommand{\imprimirsumario}{ %
	\pdfbookmark[0]{Sumário}{toc}
	\tableofcontents*
	\cleardoublepage
}

% Modifica o espaçamento no sumário
% Nao ha espacos
\setlength{\cftbeforeparagraphskip}{0pt}
\setlength{\cftbeforesubsectionskip}{0pt}
\setlength{\cftbeforesectionskip}{0pt}
\setlength{\cftbeforesubsubsectionskip}{0pt}
\setlength{\cftbeforechapterskip}{0pt}

%\renewcommand\cftchapterfont{\normalsize}
\renewcommand\cftsectionfont{\normalsize\normalfont}
\renewcommand\cftsubsectionfont{\normalsize}
\renewcommand\cftsubsubsectionfont{\normalsize\normalfont}
% Altera a fonte da seção quinária
\renewcommand*{\cftparagraphfont}{\normalsize\normalfont\itshape}

% Páginas do sumário não podem ser negrito.
\renewcommand\cftchapterpagefont{\normalfont}
\renewcommand\cftsectionpagefont{\normalfont}
\renewcommand\cftsubsectionpagefont{\normalfont}
% Altera a fonte da seção quinária
\renewcommand\cftparagraphpagefont{\normalfont}

% Secao Secundaria (Section): Caixa alta, Não Negrito, tamanho 12
\makeatletter
\let\oldcontentsline\contentsline
\def\contentsline#1#2{%
	\expandafter\ifx\csname l@#1\endcsname\l@section %
	\expandafter\@firstoftwo %
	\else %
	\expandafter\@secondoftwo %
	\fi %
	{%
		\oldcontentsline{#1}{\MakeTextUppercase{#2}}%
	}{%
	\oldcontentsline{#1}{#2}%
}%
}
\makeatother
% ---

%Para que a nota de rodapé apareça onde ela pertence, e não colada ao texto, a seguinte linha de comando é usada:

\renewcommand{\footnoterule}{\vfill\kern -3pt \hrule width 0.4\columnwidth \kern 2.6pt}

%Esta técnica (mas bem "dica") foi encontrada em: https://tex.stackexchange.com/questions/4902/why-is-my-footnote-glued-to-the-text


% ---
% FIM DAS CUSTOMIZACOES PARA A UNIVERSIDADE XXX
% ---